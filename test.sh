#!/bin/sh
set -eux
record='{"text":"The life on the big cities roofs is always beautiful and cleaner than the ground~World : City of Glass (Night)by Hiyu#VRChat #VRChatPhotography #VirtualPhotography #VRChat_world紹介 #ShockyReportvrchat.com/home/world/w...","$type":"app.bsky.feed.post","embed":{"$type":"app.bsky.embed.images","images":[{"alt":"cityscape from the rooftops","image":{"$type":"blob","ref":{"$link":"bafkreibv3ndp4p7dnmilh5slrqtyr3lpfzuvu2hes72gqhxlbzqbounmii"},"mimeType":"image/jpeg","size":329666},"aspectRatio":{"width":1920,"height":1080}},{"alt":"cityscape from the rooftops","image":{"$type":"blob","ref":{"$link":"bafkreiaabtxafoavi5r5xw64b7gb6fv45gug6hbcu2wmhf3gi236spsje4"},"mimeType":"image/jpeg","size":957868},"aspectRatio":{"width":1920,"height":1080}},{"alt":"grey cityscape from the street","image":{"$type":"blob","ref":{"$link":"bafkreig577gxjig7b7yixzafgr6znfeerwpzc2uei2g5nebveuts27vfre"},"mimeType":"image/jpeg","size":346215},"aspectRatio":{"width":1920,"height":1080}},{"alt":"futuristic modern interior ","image":{"$type":"blob","ref":{"$link":"bafkreidht7kwqwvyrpnn5pzszgmfx2kd72det57gp7jxo5uzruvc3mqeiq"},"mimeType":"image/jpeg","size":537684},"aspectRatio":{"width":1920,"height":1080}}]},"langs":["en"],"facets":[{"index":{"byteEnd":130,"byteStart":123},"features":[{"tag":"VRChat","$type":"app.bsky.richtext.facet#tag"}]},{"index":{"byteEnd":149,"byteStart":131},"features":[{"tag":"VRChatPhotography","$type":"app.bsky.richtext.facet#tag"}]},{"index":{"byteEnd":169,"byteStart":150},"features":[{"tag":"VirtualPhotography","$type":"app.bsky.richtext.facet#tag"}]},{"index":{"byteEnd":189,"byteStart":170},"features":[{"tag":"VRChat_world紹介","$type":"app.bsky.richtext.facet#tag"}]},{"index":{"byteEnd":203,"byteStart":190},"features":[{"tag":"ShockyReport","$type":"app.bsky.richtext.facet#tag"}]},{"index":{"byteEnd":231,"byteStart":205},"features":[{"uri":"https://vrchat.com/home/world/wrld_dd2650ab-0065-459e-af05-b2a2be569b65","$type":"app.bsky.richtext.facet#link"}]}],"createdAt":"2024-11-27T10:33:33.249Z"}'
packed='{"did":"did:plc:3supx2bf4t7nz3dstxwviefk","kind":"commit","commit":{"operation":"create","collection":"app.bsky.feed.post","rkey":"amogus","record":'$record'}}'
as_str=$(echo "$packed" | jq -R '.')

echo "send VRHose.Ingestor, {:websocket_text, DateTime.utc_now(), "$as_str"}"
